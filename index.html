<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Galeri Karya Siswa</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f4f4f4;
    }
    h1 {
      text-align: center;
    }
    .container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .card {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 16px;
    }
    .card img {
      width: 100%;
      height: auto;
      border-radius: 4px;
    }
    .card h3 {
      margin-top: 10px;
    }
    .card p {
      font-size: 14px;
    }
  </style>
</head>
<body>

<h1>Galeri Karya Siswa</h1>
<div class="container" id="karyaContainer">
  Loading data...
</div>

<script>
  const url = "https://script.google.com/macros/s/AKfycbwJGVdOje7xKo9Sp6nO0roUxyknW_0pZsGAVbTszVsG2gzIBd2hIf06aui0Zt0ppGwvQQ/exec";

  fetch(url)
    .then(response => response.json())
    .then(data => {
      const container = document.getElementById('karyaContainer');
      container.innerHTML = ""; // kosongkan "Loading..."

      data.forEach((item, index) => {
        const card = document.createElement('div');
        card.className = 'card';

        const imageUrl = convertToPreviewUrl(item['Foto Karya']);

        card.innerHTML = `
          <img src="${imageUrl}" alt="Foto Karya">
          <h3>${item['Judul Karya']}</h3>
          <p><strong>Nama:</strong> ${item['Nama Siswa']}</p>
          <p><strong>Kelas:</strong> ${item['Kelas']}</p>
          <p>${item['Deskripsi']}</p>
        `;
        container.appendChild(card);
      });
    })
    .catch(error => {
      console.error("Gagal memuat data:", error);
      document.getElementById('karyaContainer').innerText = "Gagal memuat data.";
    });

  function convertToPreviewUrl(driveLink) {
    const match = driveLink.match(/[-\w]{25,}/);
    if (match) {
      return `https://drive.google.com/uc?export=view&id=${match[0]}`;
    }
    return "";
  }
</script>

</body>
</html>
